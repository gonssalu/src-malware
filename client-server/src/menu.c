#include "menu.h"

int showMenu() {
  int choice;

  printf("\nChoose an attack:\n");
  printf("1. TCP Socket Connection\n");
  printf("2. Simple Code Injection Menu\n");
  printf("3. Buffer Overflow Attack\n");
  printf("4. Hacking Scenario\n");
  printf("5. DoS Attack\n");
  printf("0. Exit\n");
  printf("Enter your choice: ");

  if (scanf("%d", &choice) != 1) {
    printf("Invalid input. Please enter a number.\n");
    choice = -1;
  }

  getchar();  // Remove newline character from buffer

  return choice;
}

int getInjectionMenuChoiceFromUser() {
  int choice;
  while (1) {
    printf("\nChoose mode:\n");
    printf("1. Unrestricted\n");
    printf("2. With Space Protection\n");
    printf("3. With Proper Validation\n");
    printf("0. Back\n");
    printf("Enter your choice: ");

    if (scanf("%d", &choice) == 1) {
      getchar();  // Remove newline character from buffer
      if (choice >= 0 && choice <= 3) return choice;
    } else {
      getchar();
    }

    printf("Invalid choice\n");
  }
}

int simpleCodeInjectionMenu(char *targetIP) {
  int choice = getInjectionMenuChoiceFromUser();
  switch (choice) {
    case 0:
      return 0;
    case 1:
      simpleCodeInjection(targetIP, TYPE_NORMAL);
      break;
    case 2:
      simpleCodeInjection(targetIP, TYPE_SPACE_PROTECTION);
      break;
    case 3:
      simpleCodeInjection(targetIP, TYPE_DOMAIN);
      break;
    default:
      printf("Invalid choice\n");
  }
  return 1;
}