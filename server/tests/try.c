 #include<stdio.h>
 
 void executingCode(){
    printf("Exploited executingCode()\n");
 }

 void realOne(){
    printf("Method as intended\n");
 }
 
 int main()
 {
    int array[5];
    int var = 0;
    int var2 = 0;

    void (*exc)(void) = realOne;

    printf("executingCode(): %p\n", executingCode);
    printf("array: %p\n", &array);
    printf("array[-2]: %p\n", &array[-2]);
    printf("array[1]: %p\n", &array[1]);
    printf("var: %p\n", &var);
    printf("var2: %p\n", &var2);
    printf("exc: %p\n", &exc);

    // read in user input
    printf("\nEnter index and value to write:");
    scanf("%i", &var);
    scanf("%i", &var2);

    array[var] = var2;

    printf("\nvar: %i\n", var);
    printf("var2: %i\n", var2);
    printf("array[-1]: %i\n\n", array[-1]);

    exc();

    return 0;
 }

 // Code Injection
 // Arbitrary Code Execution

 // DNS resolver
 // 